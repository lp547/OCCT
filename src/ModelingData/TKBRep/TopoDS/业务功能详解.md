# OCCT 业务功能与 TopoDS 的角色

## 1. 业务背景：什么是 BRep？
在 CAD（计算机辅助设计）领域，表示三维物体最主流的方法是 **BRep (Boundary Representation，边界表示法)**。
BRep 的核心思想是：**通过物体的边界（面、边、点）来定义物体**。
*   一个立方体是由6个平面（Face）围成的。
*   一个面是由4条边（Edge）围成的。
*   一条边是由2个点（Vertex）界定的。

**OCCT (Open CASCADE Technology)** 是一个开源的工业级 3D 建模内核，它的核心能力就是处理 BRep 数据。

## 2. TopoDS 模块的核心业务价值
`TopoDS` (Topological Data Structure) 是 OCCT 实现 BRep 的**地基**。它的主要业务功能如下：

### 2.1 拓扑与几何分离 (Separation of Topology and Geometry)
这是一个极其重要的设计理念。
*   **几何 (Geometry)**：描述形状的数学属性。例如，“圆柱面”、“贝塞尔曲线”、“点(10, 20, 30)”。几何只关心“形状长什么样”。
*   **拓扑 (Topology)**：描述形状的连接关系和范围。例如，“这个面使用了那个圆柱面的一部分”、“这条边连接了点A和点B”。

`TopoDS` 负责**拓扑**部分。它不存储坐标值，它存储的是**关系**。
*   **业务优势**：这种分离使得同一个几何对象可以被多个拓扑对象共享，极大降低了内存消耗。例如，一个圆柱体侧面由两个半圆柱面组成，它们可以共享同一个底层的“圆柱曲面几何定义”。

### 2.2 复杂的组合体管理 (Assembly Management)
在工业设计中，我们需要组装成千上万个零件。`TopoDS` 提供了 `Compound`（复合体）和 `CompSolid`（复合实体）来管理这种层级结构。
*   **业务优势**：可以轻松处理像“汽车引擎”这样包含数千个零件的复杂模型。

### 2.3 共享与实例化 (Sharing and Instancing)
`TopoDS` 允许不同的形状共享相同的底层数据。
*   **例子**：如果你在场景中放置了 100 个相同的螺栓，`TopoDS` 只会存储 1 份螺栓的几何数据，然后创建 100 个轻量级的 `TopoDS_Shape`，每个都有不同的**位置 (Location)**。
*   **业务优势**：极高的内存效率和渲染性能。

### 2.4 局部坐标系 (Local Coordinate Systems)
每个 `TopoDS_Shape` 都携带一个 `Location`（位置变换矩阵）。这意味着我们可以定义一个形状，然后把它“移动”或“旋转”到空间的任何地方，而不需要修改它内部的几何数据。

## 3. 业务流程概览
对于一个 CAD 软件开发者来说，使用 TopoDS 的典型业务流程如下：

1.  **创建几何**：使用 `Geom` 包创建纯几何对象（如 `Geom_Plane`, `Geom_Line`）。
2.  **构建拓扑**：使用 `BRep_Builder`（基于 `TopoDS_Builder`）将几何对象包装成拓扑对象（如 `TopoDS_Face`, `TopoDS_Edge`）。
3.  **组合形状**：将 Edge 连成 Wire，将 Wire 围成 Face，将 Face 缝合成 Shell，最终形成 Solid。
4.  **算法处理**：对 TopoDS 形状进行布尔运算（并、交、差）、倒角、抽壳等高级操作。